<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>SSML Demo avec edge-tts</title>
    <style>
        /* Simple CSS pour styliser la page */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        header, footer {
            text-align: center;
            margin-bottom: 20px;
        }
        textarea {
            width: 100%;
            height: 300px;
            margin-bottom: 10px;
        }
        label {
            font-weight: bold;
        }
        button {
            background-color: #007BFF;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        audio {
            display: block;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Démo SSML avec edge-tts</h1>
        <p>Testez et modifiez du SSML pour générer de l'audio.</p>
    </header>

    <main>
        <!-- Zone de texte pour le SSML -->
        <label for="ssml-input">Texte SSML :</label>
        <textarea id="ssml-input">
<speak>
    <p>Bienvenue dans cette démonstration complète des balises SSML !</p>
    <p>
        Voici un exemple avec une pause de <break time="500ms"/> et un changement de voix :
        <voice name="en-US-AriaNeural">
            Hello, I am Aria speaking in English.
        </voice>
    </p>
</speak>
        </textarea>

        <!-- Sélection de la voix -->
        <label for="voice-select">Voix par défaut :</label>
        <select id="voice-select">
            <option value="fr-FR-DeniseNeural">Français - Denise</option>
            <option value="en-US-AriaNeural">Anglais - Aria</option>
        </select>

        <!-- Bouton pour générer l'audio -->
        <button id="generate-audio">Générer l'audio</button>

        <!-- Section pour afficher les résultats -->
        <section id="result" style="display:none;">
            <audio controls id="audio-player"></audio>
            <a id="download-link" href="#" download="output.mp3">Télécharger l'audio</a>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Démo SSML avec edge-tts. Tous droits réservés.</p>
    </footer>

    <script>
        document.getElementById('generate-audio').addEventListener('click', async () => {
            const ssml = document.getElementById('ssml-input').value;
            const voice = document.getElementById('voice-select').value;
            const synthesizeSpeech = async (text, voice, rate, volume, pitch) => {

    if (response.ok) {
        const blob = await response.blob();
        const url = URL.createObjectURL(blob);
        const audio = new Audio(url);
        audio.play();
    } else {
        console.error('Erreur lors de la synthèse vocale');
    }
};
            try {
                // Envoi de la requête au backend
                const response = await fetch('https://ssml-tts-edge.onrender.com/synthesize', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text, voice, rate, volume, pitch })
                });

                if (!response.ok) throw new Error('Erreur lors de la génération.');

                const blob = await response.blob();
                const audioUrl = URL.createObjectURL(blob);

                // Mise à jour du lecteur audio et du lien de téléchargement
                const audioPlayer = document.getElementById('audio-player');
                const downloadLink = document.getElementById('download-link');
                audioPlayer.src = audioUrl;
                downloadLink.href = audioUrl;

                // Affichage des résultats
                document.getElementById('result').style.display = 'block';
            } catch (error) {
                alert('Une erreur est survenue lors de la génération de l\'audio.');
            }
        });
    </script>
</body>
</html>
